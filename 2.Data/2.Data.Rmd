---
title: |
  | 《生物实验设计》
  | 第二章$~$资料整理与特征数计算
author: |
  | 王超
  | 
  | 广东药科大学
  | Email: wangchao@gdpu.edu.cn
date: "`r Sys.Date()`"
fontsize: 10pt
output: beamer_presentation
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(dev = 'pdf')
library(ggplot2)
library(showtext)
showtext::showtext_auto()
```
## 

\LARGE 第二章$~$资料整理与特征数计算

## 

- 在试验及调查中能够获得大量的原始数据，这是在一定条件下对某种具体事物或现象观察的结果，称之为**资料**。

- 统计分析就是对资料的整理分析，列出统计表，绘出统计图，计算特征数。

## 第一节$~$资料的搜集与整理$~$`一、资料的类型`
对资料的分类整理， 必须坚持**同质**的原则。

只有同质的试验数据，才能根据科学原理来分类，使资料能正确反映事物的本质和规律。

- 数量性状资料（定量）

- 质量性状资料（定性）

## 第一节$~$资料的搜集与整理$~$`一、资料的类型`
（一）数量性状资料

数量性状资料一般由计数和测量或度量得到的。

- 计数资料：由计数法得到的数据（非连续变量）。

- 计量资料：由测量或度量所得的数据（连续变量）
  - 依试验的要求和测量仪器或工具的精度而定。

## 第一节$~$资料的搜集与整理$~$`一、资料的类型`

（二）质量性状资料

对某种现象只能观察而不能测量的资料。

一般需要先把质量性状资料数量化，可以采用：

1. 统计次数法

- 根据某一质量性状的类别统计其次数或频数，以次数和频数作为该质量性状的数据。

2. 评分法

- 评分是用数字级别表示某现象在表现程度上的差别。
- 根据评分将质量性状资料进行量化，然后参照计数资料的处理方法进行。

## 第一节$~$资料的搜集与整理$~$`二、资料的搜集`

（一）调查

1. 全面调查/普查
  
  - 对研究对象的每一个个体逐一进行调查
  - 范围广、时间长、工作量大
  - 极少数情况

2. 抽样调查

  - 根据一定的原则对研究对象抽取一部分个体进行测量或度量
  
  - 把得到的数据资料作为样本进行统计处理，然后利用样本特征数对总体参数进行推断
    
  - 要想无偏差估计总体，重要的是采用科学的抽样方法

## 第一节$~$资料的搜集与整理$~$`二、资料的搜集`

抽样调查

  1. 随机抽样
  
  在试验过程中对试验单位的抽样、分组等都必须遵守随机原则，避免人为主观因素的影响
  
  2. 顺序抽样
  
  - 按照既定顺序从总体中抽取一定数量的个体构成样本
  
  3. 典型抽样
  
  - 根据初步资料或经验判断，有意识、有目的地选择一个典型群体作为代表进行调查，以估计整个总体
  
可以混合地才采用以上集中抽样方法。

## 第一节$~$资料的搜集与整理$~$`二、资料的搜集`

随机抽样

随机抽样必须满足两个条件：

- 总体中每个个体被抽中的机会是均等的

- 总体中任意一个个体是否被抽中是相互独立的（不受其他个体影响）

随机抽样的方法：

 1. 简单随机抽样
 
 2. 分层随机抽样
 
 3. 整体抽样
 
 4. 双重抽样
 
## 第一节$~$资料的搜集与整理$~$`二、资料的搜集`

（二）试验

通过一定数量有代表性的试验单位，在一定的条件下进行的有探索性的研究工作。

试验处理原则：

  1. 随机
  2. 重复
  3. 局部控制

试验设计方法在第九章介绍。

## 第一节$~$资料的搜集与整理$~$`三、资料的整理`

- 原始资料的检查与核对

- 频数分布表

- 频数分布图

## 频数分布表

100只鸡每月产蛋数（用`rnorm`随机生成这样一组数据）

```{r}
set.seed(2022)
egg <- round(rnorm(100, mean = 14, sd = 1.5))
egg
summary(egg)
```
利用`summary`可以大致了解数据的分布情况。

## R demo
```{r}
fdt_eg <- table(egg) #次数统计
addmargins(fdt_eg)
prop.table(fdt_eg) #频率统计
addmargins(prop.table(fdt_eg))
```

## 分组统计
300个麦穗的每穗穗粒数
\tiny
```{r}
set.seed(2022)
wheat <- round(rnorm(300, mean = 40, sd = 7))
wheat[1:100]
summary(wheat)
```
## R demo
```{r tidy=TRUE}
fdt_wt <- table(cut(wheat, breaks = seq(15, 60, 5), include.lowest = TRUE))
addmargins(fdt_wt)
prop.table(fdt_wt) #频率统计
addmargins(prop.table(fdt_wt))
```
## 计量资料的整理
\tiny
```{r}
set.seed(2022)
fish <- round(rnorm(150, mean = 55, sd = 9))
fish[1:100]
summary(fish)
```
\normalsize
## R demo
```{r tidy=TRUE}
fdt_wt <- table(cut(wheat, breaks = seq(15, 60, 5), include.lowest = TRUE))
addmargins(fdt_wt)
prop.table(fdt_wt) #频率统计
addmargins(prop.table(fdt_wt))
```
## 频数分布图

```{r tidy=TRUE, fig.show='hold', fig.asp=1, crop=TRUE, out.width='30%'}
plot(fdt_eg, type = "h", main = "月产蛋次数分布条形图")
plot(fdt_eg, type = "p", main = "月产蛋次数分布散点图", pch=20)
pie(prop.table(fdt_eg), main = "月产蛋次数分布饼图")
```

## `plot`之外的方法
```{r fig.show='hold', fig.asp=1, fig.align='center', crop=TRUE, out.width='50%'}
barplot(fdt_eg, main = "月产蛋次数分布条形图", 
        ylab = "次数", xlab = "月产蛋数/枚")
```

## 直方图

```{r fig.align='center', fig.asp=1, crop=TRUE, out.width='50%'}
hist(wheat, main="鲢鱼体长次数分布直方图", ylab="次数", xlab="体长/cm")
```

## 第二节$~$资料特征数的计算

## 一、平均数

- 算数平均数：
$$
\mu = \frac{x_1+x_2+x_3+\cdots+x_N}{N} =\frac{1}{N} \sum_{i=1}^{N} x_i
$$
$$
\bar{x} = \frac{x_1+x_2+x_3+...+x_N}{n} =\frac{1}{n} \sum_{i=1}^{n} x_i
$$
- 中位数：
$$
M_d=x_\frac{n+1}{2}
$$
或者 
$$
M_d=(x_\frac{n}{2} + x_{\frac{n}{2}+1})/2
$$

- 众数：
$M_o$
- 几何平均数：
$$
G=\sqrt[n]{x_1\cdot x_2\cdot x_3\cdot \cdots \cdot x_n}=\sqrt[n]{\prod_{i=1}^{n}x_i}
$$

## 算数平均数计算方法
1.直接及算法
2.加减常数法



## 课程考核

- 成绩评定
  - 平时成绩
  - 考试成绩
  
- 作业要求
  - 独立思考
  - 演算正确
  - 作图清楚
  - 书写整齐
  
```{r, include=FALSE}
knitr::opts_chunk$set(dev = 'pdf')
knitr::knit_hooks$set(crop = knitr::hook_pdfcrop)
```
```{r fig.showtext = TRUE, fig.height = 5, fig.align = 'center', echo = FALSE, message = FALSE, warning = FALSE, crop = TRUE}
library(showtext)
library(ggplot2)
showtext_auto(enable = TRUE)
font_add("MicrosoftYaHei", "msyh.ttc")
#create pie chart
pie(c(30, 70), labels = c("平时成绩 30%", "考试成绩 70%"), clockwise = TRUE, radius = 0.5, col = RColorBrewer::brewer.pal(3, name = "Pastel1"), family = "MicrosoftYaHei", cex = 0.5)
# ggplot(data, aes(x="", y="比例", fill="成绩")) +
#   geom_bar(stat="identity", width=1) +
#   coord_polar("y", start=0) +
#   geom_text(aes(label = paste0(amount, "%")), position = position_stack(vjust=0.5)) +
#   labs(x = NULL, y = NULL) +
#   theme_classic() +
#   theme(axis.line = element_blank(),
#           axis.text = element_blank(),
#           axis.ticks = element_blank()) +
#   scale_fill_brewer(palette="Blues")
```

## 学习重点

- 重点讲解统计方法在生物学中的应用；
- 了解公式的推导和证明；
- 及时完成作业，按时提交和反馈。

## 

\LARGE 第一章$~$概论

## 第一节$~$生物统计学的概念

- 生物统计学是数理统计在生物学研究中的应用

- 用数理统计的原理和方法来分析和解释生物界各种现象和试验调查资料的科学

- 属于生物数学的范畴
  - 涉及到数列、排列、组合、矩阵、微积分等知识
  
## 为什么要学习统计学


## 第二节$~$统计学发展概况
- 统计实践随着计数活动开始（原始社会）

- 上升到理论成为系统的统计学（17世纪英国）
  - 政治算数：Political Arithmetick, 1690, W. Petty. 
  - 该书分为两部分：英法荷三国国力比较，英国国情国力和增长分析

- 发展经历三个阶段
  - 古典记录统计学
  - 近代描述统计学
  - 现代推断统计学

## 一、古典记录统计学

## 二、近代描述统计学

## 三、现代推断统计学

## 第三节$~$常用统计学术语

- 总体与样本

- 参数与统计数

- 变量与资料

- 因素与水平

## 一、总体与样本

## 二、参数与统计数

## 三、变量与资料

## 四、因素与水平

## 五、处理与重复

## 六、效应与互作

## 七、因素与水平

## 八、误差和错误

- 误差：也称为试验误差，是指观测值偏离真值的差异，分为随机误差和系统误差。
  - 随机误差：由于试验中许多无法控制的偶然因素所造成的试验结果与真实值之间的差异，是**不可避免**的。
  - 系统误差：由于试验处理以外的其他条件明显不一致所产生的带有倾向性的或定向性的偏差。

- 错误：在实验过程中，人为因素引起的差错。

## 第四节$~$生物统计学的内容与作用



